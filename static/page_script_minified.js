var reffedElements,functionsOnServerObjectArgs,objVersions,logVersion,script=document.createElement("script");script.src="https://code.jquery.com/jquery-3.4.1.min.js",script.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(script),window.onload=function(){function e(e,n,t){e.pageEls.hasOwnProperty(n)&&(null==t.error?(e.escape&&Object.keys(t).forEach((e,n)=>{"update"!=e&&(t[e]=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/ /g,"&nbsp").replace(/\n/g,"<br>")}(t[e]))}),e.pageEls[n].forEach((e,n)=>{null!=t.user_exception?function(e,n){var t=document.createElement("div");t.innerHTML=n,t.classList.add("error-text"),e.innerHTML="",e.appendChild(t)}(e,t.user_exception):e.innerHTML=t.value})):alert(t.error))}function n(e){e.objects.forEach((e,n)=>{functionsOnServerObjectArgs[e.index](e.evaluated),objVersions[e.index]=e.version}),logVersion=e.log.version,e.log.updated&&console.log(e.log.log)}reffedElements={},$.getJSON(window.location.pathname+"?what=json",function(t){logVersion=t.log.version,objVersions=[],t.objects.forEach((e,n)=>{reffedElements[e.ref]={kind:e.kind,escape:e.escape,pageEls:[]},objVersions.push(e.version)});for(let t of document.body.getElementsByTagName("*")){var o=t.getAttribute("serverref");if(null!=o&&reffedElements.hasOwnProperty(o)){var r=reffedElements[o],s=t.getAttribute("itemtype");switch(null==s&&(s="null"),r.pageEls.hasOwnProperty(s)?r.pageEls[s].push(t):r.pageEls[s]=[t],r.kind){case"function":"button"==s&&function(o,r){$(t).bind("click",function(){return $.post(window.location.pathname,{ref:o,action:"button",obj_versions:JSON.stringify(objVersions),log_version:logVersion},function(t,o){var s=JSON.parse(t);e(r,"output",s),null!=s.update&&n(s.update)}),!1})}(o,r);break;case"toggle":"button"==s&&function(o,r){$(t).bind("click",function(){var t,s=r.pageEls.value[0].innerHTML;if(!(!s in["true","false"]))return t="true"!=s,$.post(window.location.pathname,{ref:o,action:"set",value:t,obj_versions:JSON.stringify(objVersions),log_version:logVersion},function(t,o){var s=JSON.parse(t);e(r,"value",s),null!=s.update&&n(s.update)}),!1})}(o,r);break;case"input":"button"==s&&function(o,r){$(t).bind("click",function(){var t=[];for(let e of r.pageEls.fields[0].getElementsByTagName("input"))t.push(e.value);return $.post(window.location.pathname,{ref:o,action:"button",field_values:JSON.stringify(t),obj_versions:JSON.stringify(objVersions),log_version:logVersion},function(t,o){var s=JSON.parse(t);e(r,"output",s),null!=s.update&&n(s.update)}),!1})}(o,r)}}}functionsOnServerObjectArgs=[],t.objects.forEach((n,t)=>{var o=reffedElements[n.ref];if(null!=o)switch(n.kind){case"output":return null==o.pageEls.null?void functionsOnServerObjectArgs.push(function(e){}):void function(n){functionsOnServerObjectArgs.push(function(t){e(n,"null",t)})}(o);case"toggle":return null==o.pageEls.value?void functionsOnServerObjectArgs.push(function(e){}):void function(n){functionsOnServerObjectArgs.push(function(t){e(n,"value",t)})}(o);default:functionsOnServerObjectArgs.push(function(e){})}else functionsOnServerObjectArgs.push(function(e){})}),functionsOnServerObjectArgs.forEach((e,n)=>{e(t.objects[n].evaluated)})}),$("#refresh").bind("click",function(){return $.getJSON(window.location.pathname+"?what=json",function(e){functionsOnServerObjectArgs.forEach((n,t)=>{n(e.objects[t].evaluated)})}),!1})};